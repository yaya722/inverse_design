# 神经网络与遗传算法优化项目

## 项目简介
本项目实现了一个基于改进的1D-CNN和线性注意力机制的深度学习模型，用于多参数预测任务。模型融合了RoPE位置编码和线性注意力机制，在保持高效计算的同时提供了优秀的预测性能。

## 模型架构
- **基础架构**: 1D-CNN + 线性注意力机制
- **创新点**:
  - RoPE（Rotary Position Embedding）位置编码
  - 线性注意力机制（LinearAttention）
  - 多阶段残差结构
  - 自适应学习率调整

### 核心组件
1. **RoPE位置编码**
   - 更好地捕捉序列中的位置信息
   - 支持序列的外推能力

2. **线性注意力层**
   - 降低计算复杂度
   - 集成局部位置编码（LEPE）
   - 多头注意力机制

3. **残差块**
   - 深度可分离卷积
   - 批量归一化
   - Mish激活函数

## 性能指标
- 总体R²分数: 0.880
- 各输出变量R²分数:
  - 输出1: 0.8693
  - 输出2: 0.8279
  - 输出3: 0.8698
  - 输出4: 0.8973
  - 输出5: 0.9359

## 使用方法

### 环境要求
```bash
Python 3.7+
PyTorch 1.8+
NumPy
scikit-learn
matplotlib
tqdm
```

### 训练模型
```python
python cnn_1d_fix_parameter.py
```

### 数据格式
- 输入数据: .mat格式
- 数据结构:
  - 'absorptions': 光谱数据
  - 'parameters': 目标参数

## 模型参数
- 批量大小: 256
- 学习率: 0.0009249609392561427
- 权重衰减: 3.372482718194792e-04
- Dropout率: 0.07499385126240433
- 训练轮数: 209
- 早停耐心值: 30

## 训练策略
1. 学习率预热（7个epoch）
2. 自适应学习率调整
3. 早停机制
4. 权重衰减正则化
5. 多阶段训练

## 可视化
模型训练过程会生成以下可视化结果：
- training_metrics.png: 预测值与真实值对比
- loss_curve.png: 训练和验证损失曲线

## 模型保存
- best_loss_model.pth: 基于验证损失的最佳模型
- best_r2_model.pth: 基于R²分数的最佳模型